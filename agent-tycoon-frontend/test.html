<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Agentå¤§äº¨ - æµ‹è¯•é¡µé¢</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #0f0f0f; color: #fff; line-height: 1.6; }
    .container { max-width: 1200px; margin: 50px auto; padding: 20px; }
    .status { padding: 10px 20px; border-radius: 8px; margin: 10px 0; }
    .success { background: #52c41a; }
    .error { background: #ff4d4f; }
    h1 { color: #1890ff; }
    h2 { color: #52c41a; }
    code { background: #1a1a1a; padding: 10px; border-radius: 4px; display: inline-block; }
    pre { background: #1a1a1a; padding: 15px; border-radius: 8px; overflow-x: auto; }
    .test-btn { padding: 12px 24px; font-size: 16px; background: #1890ff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    .test-btn:hover { background: #40a9ff; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ® AI Agentå¤§äº¨ï¼šç»æµæˆ˜åœº</h1>
    <p>ç³»ç»Ÿæµ‹è¯•é¡µé¢</p>
    
    <div id="frontend-status">
      <h2>å‰ç«¯çŠ¶æ€</h2>
      <p>æ­£åœ¨æ£€æµ‹...</p>
    </div>

    <div id="backend-status">
      <h2>åç«¯çŠ¶æ€</h2>
      <p>æ­£åœ¨æ£€æµ‹...</p>
    </div>

    <div id="network-status">
      <h2>ç½‘ç»œè¿é€šæ€§</h2>
      <p>æ­£åœ¨æ£€æµ‹...</p>
    </div>

    <div class="actions">
      <button class="test-btn" onclick="testFrontend()">æµ‹è¯•å‰ç«¯</button>
      <button class="test-btn" onclick="testBackend()">æµ‹è¯•åç«¯</button>
      <button class="test-btn" onclick="testAll()">å…¨é¢æµ‹è¯•</button>
    </div>

    <div id="results"></div>
  </div>

  <script>
    const API_BASE = 'http://43.156.102.103:3000';
    const FRONTEND_URL = 'http://43.156.102.103:5173';

    async function testFrontend() {
      const status = document.getElementById('frontend-status');
      try {
        const response = await fetch(FRONTEND_URL);
        if (response.ok) {
          status.className = 'status success';
          status.innerHTML = '<h2>âœ… å‰ç«¯æ­£å¸¸</h2><p>å¯ä»¥è®¿é—®</p>';
        } else {
          throw new Error('Frontend returned ' + response.status);
        }
      } catch (error) {
        status.className = 'status error';
        status.innerHTML = '<h2>âŒ å‰ç«¯æ— æ³•è®¿é—®</h2><p>' + error.message;
      }
    }

    async function testBackend() {
      const status = document.getElementById('backend-status');
      try {
        const response = await fetch(API_BASE + '/health');
        if (response.ok) {
          const data = await response.json();
          status.className = 'status success';
          status.innerHTML = '<h2>âœ… åç«¯æ­£å¸¸</h2><p>å¯ä»¥è®¿é—®</p>';
          status.innerHTML += '<p>ç¯å¢ƒ: ' + data.environment + '</p>';
          status.innerHTML += '<p>ç‰ˆæœ¬: ' + data.version + '</p>';
        } else {
          throw new Error('Backend returned ' + response.status);
        }
      } catch (error) {
        status.className = 'status error';
        status.innerHTML = '<h2>âŒ åç«¯æ— æ³•è®¿é—®</h2><p>' + error.message;
      }
    }

    async function testNetwork() {
      const status = document.getElementById('network-status');
      try {
        // æµ‹è¯•å‰ç«¯
        const frontCheck = await fetch(FRONTEND_URL);
        // æµ‹è¯•åç«¯
        const backCheck = await fetch(API_BASE + '/health');
        
        if (frontCheck.ok && backCheck.ok) {
          status.className = 'status success';
          status.innerHTML = '<h2>âœ… ç½‘ç»œæ­£å¸¸</h2><p>å¯ä»¥è®¿é—®å‰ç«¯å’Œåç«¯</p>';
        } else {
          status.className = 'status error';
          status.innerHTML = '<h2>âš ï¸ ç½‘ç»œå¼‚å¸¸</h2><p>å‰ç«¯çŠ¶æ€: ' + frontCheck.status + '</p>';
        }
      } catch (error) {
        status.className = 'status error';
        status.innerHTML = '<h2>âš ï¸ ç½‘ç»œå¼‚å¸¸</h2><p>' + error.message;
      }
    }

    function addResult(message: string) {
      const results = document.getElementById('results');
      const p = document.createElement('p');
      p.textContent = message;
      results.appendChild(p);
    }

    async function testAll() {
      addResult('å¼€å§‹å…¨é¢æµ‹è¯•...');
      await testFrontend();
      await testBackend();
      await testNetwork();
      addResult('æµ‹è¯•å®Œæˆï¼');
    }

    // è‡ªåŠ¨è¿è¡Œæµ‹è¯•
    window.onload = async () => {
      await testAll();
    };
  </script>
</body>
</html>
